import ssl
import socket

def scan_ssl_tls(hostname, port):
    try:
        # Create a socket and wrap it with SSL/TLS
        context = ssl.create_default_context()
        with socket.create_connection((hostname, port)) as sock:
            with context.wrap_socket(sock, server_hostname=hostname) as sslsock:
                # Get SSL/TLS certificate details
                cert = sslsock.getpeercert()
                common_name = cert['subject'][0][0][1]
                issuer = cert['issuer'][0][0][1]
                expiration_date = cert['notAfter']

                # Print the certificate details
                print("SSL/TLS Certificate Details:")
                print("Common Name (CN):", common_name)
                print("Issuer:", issuer)
                print("Expiration Date:", expiration_date)
                print("")

                # Check for known vulnerabilities or weaknesses
                # Add your custom vulnerability checks here

    except ssl.SSLError as e:
        print("Error: Failed to establish SSL/TLS connection:", str(e))
    except socket.error as e:
        print("Error: Socket connection failed:", str(e))

# Example usage
hostname = input("Enter the hostname: ")
port = int(input("Enter the port: "))

scan_ssl_tls(hostname, port)

