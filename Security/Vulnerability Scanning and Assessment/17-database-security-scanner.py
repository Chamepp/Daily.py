import psycopg2
import sys

def scan_database(hostname, port, database, username, password):
    try:
        # Connect to the database
        conn = psycopg2.connect(
            host=hostname,
            port=port,
            database=database,
            user=username,
            password=password
        )
        print("Connected to the database successfully.")

        # Perform security vulnerability checks
        # Example: Check for weak permissions on sensitive tables
        cursor = conn.cursor()
        cursor.execute("SELECT table_name FROM information_schema.tables WHERE table_schema='public';")
        tables = cursor.fetchall()
        for table in tables:
            cursor.execute("SELECT relacl FROM pg_class WHERE relname=%s;", (table,))
            permissions = cursor.fetchone()
            if permissions and ('public' in permissions[0] or 'ALL' in permissions[0]):
                print(f"Warning: Table {table[0]} has weak permissions.")

        # Close the database connection
        conn.close()
        print("Disconnected from the database.")

    except psycopg2.Error as e:
        print(f"Error connecting to the database: {e}")
        sys.exit(1)

# Example usage
hostname = input("Enter the database hostname: ")
port = input("Enter the database port: ")
database = input("Enter the database name: ")
username = input("Enter the database username: ")
password = input("Enter the database password: ")

scan_database(hostname, port, database, username, password)

